Stolen from https://raw.githubusercontent.com/bucanero/apollo-ps3/master/source/rifrap.c
